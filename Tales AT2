import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.net.Socket;

public class Cliente {
    @SuppressWarnings("ConvertToTryWithResources")
    public static void main(String[] args) {
        String message = "MjAwNg==";
        try {
            //Conecta
            Socket conexao = new Socket("10.130.34.106", 12345);
            ObjectOutputStream saida = new ObjectOutputStream(conexao.getOutputStream());
            ObjectInputStream entrada = new ObjectInputStream(conexao.getInputStream());

            // Envia mensagem
            saida.writeObject(message);
            saida.flush();

            // Mostra a mensagem
            String resposta;
            while ((resposta = (String) entrada.readObject()) != null) {
                System.out.println("Chegou no cliente a mensagem: " + resposta);
                saida.writeObject("OK " + resposta);
                saida.flush();
            }

            entrada.close();
            saida.close();
            conexao.close();
        } catch (IOException | ClassNotFoundException e) {
            e.printStackTrace();
        }
    }
}

